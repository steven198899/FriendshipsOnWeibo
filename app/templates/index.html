{% extends "base.html" %}
{% block map_script %}
<script type="text/javascript" src="//code.jquery.com/jquery.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJwmHpMg1YXC1LFIS-UiJiyeb1m2n8UWk&sensor=false"></script>
<script type="text/javascript">
var shanghai = new google.maps.LatLng(31.20042, 121.47370);
var locations = [
  ['我家', 31.15439, 121.45721],
  ['徐家汇', 31.19250, 121.44000],
  ['南京路', 31.23576, 121.48023],
  ['东方明珠', 31.23729, 121.50063]
];
var marker, i;
var map;
var infoWindow = new google.maps.InfoWindow({
    width: 200
    });

function initialize() {
  var mapOptions = {
    zoom: 12,
    center: shanghai
  };

  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

  for (i = 0; i < locations.length; i++) {
    marker = new google.maps.Marker({
        map: map,
        draggable: false,
        animation: google.maps.Animation.DROP,
        position: new google.maps.LatLng(locations[i][1], locations[i][2])
        });

    google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          infoWindow.setContent(locations[i][0]);
          infoWindow.open(map, marker);
        }
      })(marker, i));
  }
}

google.maps.event.addDomListener(window, 'load', initialize);

$(document).ready(function() {
    $('a.friend-inside').on('click', function() {
      alert($(this).attr('id'));

      $.ajax({
        type: "POST",
        dataType: "json",
        data: {
          uid: $(this).attr('id'),
        },
        success: function(response) {
          alert(response.message);
        }
        });
      return false;
      });

    });
</script>
{% endblock %}

{% block content %}
<div class="page-container">
  <div class="dashboard">
    <div class="profile module">
      <div class="row profile-container">
        <div class="col-md-6">
          <img class="avatar" src={{users['avatar_large']}}>
        </div>
        <div class="col-md-6">
          <div  class="row" style="height: 45px">
          </div>
          <div class="row" >
            <b class="fullname" >{{users['screen_name']}}</b>
          </div>
        </div>
      </div>
      <div class="row stats-container topborder">
        <div class="col-md-4 stats-item1">
          <strong class="row stats-count">{{users['statuses_count']}}</strong>
          <div class="row stats-txt">Tweets</div>
        </div>
        <div class="col-md-4 stats-item2">
          <strong class="row stats-count">{{users['friends_count']}}</strong>
          <div class="row stats-txt">Following</div>
        </div>
        <div class="col-md-4 stats-item3">
          <strong class="row stats-count">{{users['followers_count']}}</strong>
          <div class="row stats-txt">Followers</div>
        </div>
      </div>
    </div>
    <div class="friend module">
      <div class="row2 friend-header">
        <strong class="friend-title">My friends</strong>
        <div class="friends-navi">
          <a href="#">prev</a>
          <a href="#">next</a>
        </div>
      </div>
      <div class="row2 friends-container">
        {% for friend in friends %}
        <div class="row friend-item">
          <a href="#" class="friend-inside" id={{friend['id']}}>
            <img class="small-logo" src={{friend['profile_image_url']}} >
            <span class="friend-name">{{friend['name']}}</span>
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="content-main module">
    <div class="search-bar">
      <h3 class="search-form">Please input the user_id you want to search!</h3>
      <form class="search-form" name="search" action="" method="post" style="padding-top:30px">
        {{form.hidden_tag()}}
        <div class="search_form_inside">
          <p>
          {{form.searchName(size=46)}}
          <input class="btn btn-primary btn-default " type="submit" value="Search" />
          {% for error in form.errors.searchName %}
          <br/>
          <span style="color: red;">[{{error}}]</span>
          {% endfor %}
          </p>
        </div>
      </form>
    </div>

    <div class="map-content topborder" id="map-canvas"></div>
    <div class="topborder" style="height: 30px"></div>
  </div>
</div>
{% endblock %}
